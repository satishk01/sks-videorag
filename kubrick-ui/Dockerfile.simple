FROM nginx:alpine

# Copy nginx configuration
COPY nginx.conf /etc/nginx/conf.d/default.conf

# Create the HTML file directly
RUN mkdir -p /usr/share/nginx/html && \
    echo '<!DOCTYPE html>' > /usr/share/nginx/html/index.html && \
    echo '<html lang="en">' >> /usr/share/nginx/html/index.html && \
    echo '<head>' >> /usr/share/nginx/html/index.html && \
    echo '    <meta charset="UTF-8">' >> /usr/share/nginx/html/index.html && \
    echo '    <meta name="viewport" content="width=device-width, initial-scale=1.0">' >> /usr/share/nginx/html/index.html && \
    echo '    <title>Kubrick AI - AWS Bedrock</title>' >> /usr/share/nginx/html/index.html && \
    echo '    <style>' >> /usr/share/nginx/html/index.html && \
    echo '        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; background: #f5f5f5; }' >> /usr/share/nginx/html/index.html && \
    echo '        .container { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }' >> /usr/share/nginx/html/index.html && \
    echo '        .status { padding: 15px; background: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px; margin: 15px 0; }' >> /usr/share/nginx/html/index.html && \
    echo '        .api-link { display: inline-block; background: #007bff; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; margin: 10px 5px; }' >> /usr/share/nginx/html/index.html && \
    echo '        pre { background: #f8f9fa; padding: 15px; border-radius: 5px; overflow-x: auto; }' >> /usr/share/nginx/html/index.html && \
    echo '    </style>' >> /usr/share/nginx/html/index.html && \
    echo '</head>' >> /usr/share/nginx/html/index.html && \
    echo '<body>' >> /usr/share/nginx/html/index.html && \
    echo '    <div class="container">' >> /usr/share/nginx/html/index.html && \
    echo '        <h1>ğŸ¬ Kubrick AI</h1>' >> /usr/share/nginx/html/index.html && \
    echo '        <div class="status">' >> /usr/share/nginx/html/index.html && \
    echo '            <h3>âœ… System Online</h3>' >> /usr/share/nginx/html/index.html && \
    echo '            <p>AWS Bedrock Claude 3.5 Sonnet v2 â€¢ AWS Transcribe â€¢ Titan Embeddings</p>' >> /usr/share/nginx/html/index.html && \
    echo '        </div>' >> /usr/share/nginx/html/index.html && \
    echo '        <h2>ğŸš€ API Access</h2>' >> /usr/share/nginx/html/index.html && \
    echo '        <a href="/docs" class="api-link">ğŸ“š API Documentation</a>' >> /usr/share/nginx/html/index.html && \
    echo '        <a href="/" class="api-link">ğŸ” Health Check</a>' >> /usr/share/nginx/html/index.html && \
    echo '        <h2>ğŸ¯ Features</h2>' >> /usr/share/nginx/html/index.html && \
    echo '        <ul>' >> /usr/share/nginx/html/index.html && \
    echo '            <li>ğŸ¤– AWS Bedrock Claude 3.5 Sonnet v2 Agent</li>' >> /usr/share/nginx/html/index.html && \
    echo '            <li>ğŸ¥ Video Processing with AI</li>' >> /usr/share/nginx/html/index.html && \
    echo '            <li>ğŸ” Intelligent Video Search</li>' >> /usr/share/nginx/html/index.html && \
    echo '            <li>ğŸ“ AWS Transcribe Integration</li>' >> /usr/share/nginx/html/index.html && \
    echo '            <li>ğŸ§  Titan Embeddings</li>' >> /usr/share/nginx/html/index.html && \
    echo '        </ul>' >> /usr/share/nginx/html/index.html && \
    echo '        <h2>ğŸ› ï¸ Quick Start</h2>' >> /usr/share/nginx/html/index.html && \
    echo '        <pre># Upload a video' >> /usr/share/nginx/html/index.html && \
    echo 'curl -X POST "http://your-server:8080/upload-video" \' >> /usr/share/nginx/html/index.html && \
    echo '  -F "file=@your-video.mp4"' >> /usr/share/nginx/html/index.html && \
    echo '' >> /usr/share/nginx/html/index.html && \
    echo '# Chat with AI about the video' >> /usr/share/nginx/html/index.html && \
    echo 'curl -X POST "http://your-server:8080/chat" \' >> /usr/share/nginx/html/index.html && \
    echo '  -H "Content-Type: application/json" \' >> /usr/share/nginx/html/index.html && \
    echo '  -d '"'"'{"message": "What happens in this video?", "video_path": "path/to/video.mp4"}'"'"'</pre>' >> /usr/share/nginx/html/index.html && \
    echo '    </div>' >> /usr/share/nginx/html/index.html && \
    echo '</body>' >> /usr/share/nginx/html/index.html && \
    echo '</html>' >> /usr/share/nginx/html/index.html

EXPOSE 3000

CMD ["nginx", "-g", "daemon off;"]